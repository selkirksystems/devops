---
  - name: Provision an EC2 Security group
    hosts: localhost
    connection: local
    gather_facts: False
    tags: provisioning
    # Necessary Variables for creating/provisioning the EC2 Instance
    vars:
      security_group: SK-FMTWebTier-Dev # Change the security group name here
      region: us-west-2 # Change the Region
      keypair: Selkirk-PK # Change the keypair name

    # Task that will be used to Launch/Create an EC2 Security Group(s)
    tasks:
      - name: Create FMT Web security group
        local_action: 
          module: ec2_group
          name: "{{ security_group }}"
          description: Security Group for FMT Web Servers
          region: "{{ region }}"
          rules:
            - proto: tcp
              from_port: 8443
              to_port: 8443
              cidr_ip: 0.0.0.0/0
            - proto: tcp
              type: http
              from_port: 80
              to_port: 80
              cidr_ip: 0.0.0.0/0
            - proto: tcp
              from_port: 8080
              to_port: 8080
              cidr_ip: 0.0.0.0/0
          rules_egress:
            - proto: all
              type: all
              cidr_ip: 0.0.0.0/0

